<oval_definitions
  xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
  xmlns:ind-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent"
  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
  xmlns:unix-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix"
  xmlns:linux-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 oval-common-schema.xsd   http://oval.mitre.org/XMLSchema/oval-definitions-5 oval-definitions-schema.xsd   http://oval.mitre.org/XMLSchema/oval-definitions-5#independent independent-definitions-schema.xsd   http://oval.mitre.org/XMLSchema/oval-definitions-5#unix unix-definitions-schema.xsd   http://oval.mitre.org/XMLSchema/oval-definitions-5#macos linux-definitions-schema.xsd">
  <generator>
      <oval:product_name>Wazuh QA custom CVE OVAL</oval:product_name>
      <oval:product_version>0.1</oval:product_version>
      <oval:schema_version>5.11.1</oval:schema_version>
      <oval:timestamp>2022-02-22T15:30:33</oval:timestamp>
  </generator>
  <definitions>
    <definition class="inventory" id="oval:com.ubuntu.bionic:def:100" version="1">
        <metadata>
            <title>Check that Ubuntu 18.04 LTS (bionic) is installed.</title>
            <description></description>
        </metadata>
        <criteria>
            <criterion test_ref="oval:com.ubuntu.bionic:tst:100" comment="The host is part of the unix family." />
            <criterion test_ref="oval:com.ubuntu.bionic:tst:101" comment="The host is running Ubuntu bionic." />
        </criteria>
    </definition>
    <definition class="vulnerability" id="oval:com.ubuntu.bionic:def:000000000000000" version="1">
        <metadata>
            <title>QA custom packages: custom package number 0.</title>
            <description>Package created for testing purposes.</description>
            <affected family="unix">
                <platform>Ubuntu 18.04 LTS</platform>
            </affected>
            <reference source="CVE" ref_id="CVE-000" ref_url="https://github.com/wazuh/wazuh-qa" />
        </metadata>
        <criteria>
            <extend_definition definition_ref="oval:com.ubuntu.bionic:def:100" comment="Ubuntu 18.04 LTS (bionic) is installed." applicability_check="true" />
            <criteria operator="AND">
                <criterion test_ref="oval:com.ubuntu.bionic:tst:000000000000000" comment="custom-package-0 package in bionic, is related to the CVE in some way and has been fixed (note: '2.0.0')." />
            </criteria>
        </criteria>
    </definition>
    <definition class="vulnerability" id="oval:com.ubuntu.bionic:def:000000000000001" version="1">
        <metadata>
            <title>QA custom packages: custom package number 1.</title>
            <description>Package created for testing purposes.</description>
            <affected family="unix">
                <platform>Ubuntu 18.04 LTS</platform>
            </affected>
            <reference source="CVE" ref_id="CVE-001" ref_url="https://github.com/wazuh/wazuh-qa" />
        </metadata>
        <criteria>
            <extend_definition definition_ref="oval:com.ubuntu.bionic:def:100" comment="Ubuntu 18.04 LTS (bionic) is installed." applicability_check="true" />
            <criteria operator="AND">
                <criterion test_ref="oval:com.ubuntu.bionic:tst:000000000000001" comment="custom-package-1 package in bionic, is related to the CVE in some way and has been fixed (note: '2.0.0')." />
            </criteria>
        </criteria>
    </definition>
    <definition class="vulnerability" id="oval:com.ubuntu.bionic:def:000000000000002" version="1">
        <metadata>
            <title>QA custom packages: custom package number 2.</title>
            <description>Package created for testing purposes.</description>
            <affected family="unix">
                <platform>Ubuntu 18.04 LTS</platform>
            </affected>
            <reference source="CVE" ref_id="CVE-002" ref_url="https://github.com/wazuh/wazuh-qa" />
        </metadata>
        <criteria>
            <extend_definition definition_ref="oval:com.ubuntu.bionic:def:100" comment="Ubuntu 18.04 LTS (bionic) is installed." applicability_check="true" />
            <criteria operator="AND">
                <criterion test_ref="oval:com.ubuntu.bionic:tst:000000000000002" comment="custom-package-2 package in bionic, is related to the CVE in some way and has been fixed (note: '2.0.0')." />
            </criteria>
        </criteria>
    </definition>
    <definition class="vulnerability" id="oval:com.ubuntu.bionic:def:000000000000003" version="1">
        <metadata>
            <title>QA custom packages: custom package number 3.</title>
            <description>Package created for testing purposes.</description>
            <affected family="unix">
                <platform>Ubuntu 18.04 LTS</platform>
            </affected>
            <reference source="CVE" ref_id="CVE-003" ref_url="https://github.com/wazuh/wazuh-qa" />
        </metadata>
        <criteria>
            <extend_definition definition_ref="oval:com.ubuntu.bionic:def:100" comment="Ubuntu 18.04 LTS (bionic) is installed." applicability_check="true" />
            <criteria operator="AND">
                <criterion test_ref="oval:com.ubuntu.bionic:tst:000000000000003" comment="custom-package-3 package in bionic, is related to the CVE in some way and has been fixed (note: '2.0.0')." />
            </criteria>
        </criteria>
    </definition>
    <definition class="vulnerability" id="oval:com.ubuntu.bionic:def:000000000000004" version="1">
        <metadata>
            <title>QA custom packages: custom package number 4.</title>
            <description>Package created for testing purposes.</description>
            <affected family="unix">
                <platform>Ubuntu 18.04 LTS</platform>
            </affected>
            <reference source="CVE" ref_id="CVE-004" ref_url="https://github.com/wazuh/wazuh-qa" />
        </metadata>
        <criteria>
            <extend_definition definition_ref="oval:com.ubuntu.bionic:def:100" comment="Ubuntu 18.04 LTS (bionic) is installed." applicability_check="true" />
            <criteria operator="AND">
                <criterion test_ref="oval:com.ubuntu.bionic:tst:000000000000004" comment="custom-package-4 package in bionic, is related to the CVE in some way and has been fixed (note: '2.0.0')." />
            </criteria>
        </criteria>
    </definition>
  </definitions>
  <tests>
    <ind-def:family_test id="oval:com.ubuntu.bionic:tst:100" check="at least one" check_existence="at_least_one_exists" version="1" comment="Is the host part of the unix family?">
        <ind-def:object object_ref="oval:com.ubuntu.bionic:obj:100"/>
        <ind-def:state state_ref="oval:com.ubuntu.bionic:ste:100"/>
    </ind-def:family_test>
    <ind-def:textfilecontent54_test id="oval:com.ubuntu.bionic:tst:101" check="at least one" check_existence="at_least_one_exists" version="1" comment="Is the host running Ubuntu bionic?">
        <ind-def:object object_ref="oval:com.ubuntu.bionic:obj:101"/>
        <ind-def:state state_ref="oval:com.ubuntu.bionic:ste:101"/>
    </ind-def:textfilecontent54_test>
    <linux-def:dpkginfo_test id="oval:com.ubuntu.bionic:tst:000000000000000" version="1" check_existence="at_least_one_exists" check="at least one" comment="Does the 'custom-package-0' package exist and is the version equals to '2.0.0'?">
        <linux-def:object object_ref="oval:com.ubuntu.bionic:obj:000000000000000"/>
        <linux-def:state state_ref="oval:com.ubuntu.bionic:ste:000000000000006" />
    </linux-def:dpkginfo_test>
    <linux-def:dpkginfo_test id="oval:com.ubuntu.bionic:tst:000000000000001" version="1" check_existence="at_least_one_exists" check="at least one" comment="Does the 'custom-package-1' package exist and is the version equals to '2.0.0'?">
        <linux-def:object object_ref="oval:com.ubuntu.bionic:obj:000000000000001"/>
        <linux-def:state state_ref="oval:com.ubuntu.bionic:ste:000000000000006" />
    </linux-def:dpkginfo_test>
    <linux-def:dpkginfo_test id="oval:com.ubuntu.bionic:tst:000000000000002" version="1" check_existence="at_least_one_exists" check="at least one" comment="Does the 'custom-package-2' package exist and is the version equals to '2.0.0'?">
        <linux-def:object object_ref="oval:com.ubuntu.bionic:obj:000000000000002"/>
        <linux-def:state state_ref="oval:com.ubuntu.bionic:ste:000000000000006" />
    </linux-def:dpkginfo_test>
    <linux-def:dpkginfo_test id="oval:com.ubuntu.bionic:tst:000000000000003" version="1" check_existence="at_least_one_exists" check="at least one" comment="Does the 'custom-package-3' package exist and is the version equals to '2.0.0'?">
        <linux-def:object object_ref="oval:com.ubuntu.bionic:obj:000000000000003"/>
        <linux-def:state state_ref="oval:com.ubuntu.bionic:ste:000000000000006" />
    </linux-def:dpkginfo_test>
    <linux-def:dpkginfo_test id="oval:com.ubuntu.bionic:tst:000000000000004" version="1" check_existence="at_least_one_exists" check="at least one" comment="Does the 'custom-package-4' package exist and is the version equals to '2.0.0'?">
        <linux-def:object object_ref="oval:com.ubuntu.bionic:obj:000000000000004"/>
        <linux-def:state state_ref="oval:com.ubuntu.bionic:ste:000000000000006" />
    </linux-def:dpkginfo_test>
  </tests>
  <objects>
    <ind-def:family_object id="oval:com.ubuntu.bionic:obj:100" version="1" comment="The singleton family object."/>

    <ind-def:textfilecontent54_object id="oval:com.ubuntu.bionic:obj:101" version="1" comment="The singleton release codename object.">
        <ind-def:filepath>/etc/lsb-release</ind-def:filepath>
        <ind-def:pattern operation="pattern match">^[\s\S]*DISTRIB_CODENAME=([a-z]+)$</ind-def:pattern>
        <ind-def:instance datatype="int">1</ind-def:instance>
    </ind-def:textfilecontent54_object>
    <linux-def:dpkginfo_object id="oval:com.ubuntu.bionic:obj:000000000000000" version="1" comment="The 'custom-package-0' package binary.">
        <linux-def:name>custom-package-0</linux-def:name>
    </linux-def:dpkginfo_object>
    <linux-def:dpkginfo_object id="oval:com.ubuntu.bionic:obj:000000000000001" version="1" comment="The 'custom-package-1' package binary.">
        <linux-def:name>custom-package-1</linux-def:name>
    </linux-def:dpkginfo_object>
    <linux-def:dpkginfo_object id="oval:com.ubuntu.bionic:obj:000000000000002" version="1" comment="The 'custom-package-2' package binary.">
        <linux-def:name>custom-package-2</linux-def:name>
    </linux-def:dpkginfo_object>
    <linux-def:dpkginfo_object id="oval:com.ubuntu.bionic:obj:000000000000003" version="1" comment="The 'custom-package-3' package binary.">
        <linux-def:name>custom-package-3</linux-def:name>
    </linux-def:dpkginfo_object>
    <linux-def:dpkginfo_object id="oval:com.ubuntu.bionic:obj:000000000000004" version="1" comment="The 'custom-package-4' package binary.">
        <linux-def:name>custom-package-4</linux-def:name>
    </linux-def:dpkginfo_object>
  </objects>
  <states>
    <ind-def:family_state id="oval:com.ubuntu.bionic:ste:100" version="1" comment="The singleton family object.">
        <ind-def:family>unix</ind-def:family>
    </ind-def:family_state>

    <ind-def:textfilecontent54_state id="oval:com.ubuntu.bionic:ste:101" version="1" comment="Ubuntu 18.04 LTS">
        <ind-def:subexpression>bionic</ind-def:subexpression>
    </ind-def:textfilecontent54_state>
    <linux-def:dpkginfo_state id="oval:com.ubuntu.bionic:ste:200224390000000" version="1" comment="The package version is less than '0:4.8.2-19ubuntu1'.">
        <linux-def:evr datatype="debian_evr_string" operation="less than">0:4.8.2-19ubuntu1</linux-def:evr>
    </linux-def:dpkginfo_state>
    <linux-def:dpkginfo_state id="oval:com.ubuntu.bionic:ste:000000000000006" version="1" comment="The custom package version is less than '0:2.0.0'.">
        <linux-def:evr datatype="debian_evr_string" operation="less than">0:2.0.0</linux-def:evr>
    </linux-def:dpkginfo_state>
  </states>
</oval_definitions>
